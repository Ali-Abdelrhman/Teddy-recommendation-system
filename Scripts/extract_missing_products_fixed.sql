-- CORRECTED EXTRACTION OF MISSING PRODUCTS
-- Using the exact schema from our successful extraction
-- Run each chunk separately to avoid MySQL IN clause limits

-- Extract missing products - Chunk 1 (CORRECTED)
SELECT 
    p.sku_id,
    COALESCE(p.name_en, CONCAT('Product ', p.sku_id)) as name_en,
    COALESCE(p.name_ar, CONCAT('منتج ', p.sku_id)) as name_ar,
    COALESCE(p.description_en, 'Quality product available for purchase') as description_en,
    COALESCE(p.description_ar, 'منتج عالي الجودة متاح للشراء') as description_ar,
    COALESCE(p.slug, CONCAT('product-', p.sku_id)) as slug,
    COALESCE(p.is_wrappable, 1) as is_wrappable,
    COALESCE(p.is_customizable, 0) as is_customizable,
    COALESCE(p.is_international, 0) as is_international,
    COALESCE(p.is_digital, 0) as is_digital,
    COALESCE(p.origincountry, 'Saudi Arabia') as origincountry,
    COALESCE(p.subcategory_id, 1) as subcategory_id,
    COALESCE(p.brand_id, 1) as brand_id,
    COALESCE(b.name_en, 'Quality Brand') as brand_name_en,
    COALESCE(b.name_ar, 'علامة تجارية ممتازة') as brand_name_ar,
    COALESCE(cat.name_en, 'General Products') as category_name_en,
    COALESCE(cat.name_ar, 'منتجات عامة') as category_name_ar,
    COALESCE(s.code, CONCAT('SKU-', p.sku_id)) as sku_code,
    COALESCE(s.color, 'Multi-Color') as sku_color,
    s.upc,
    COALESCE(s.height, 0) as height,
    COALESCE(s.length, 0) as length,
    COALESCE(s.width, 0) as width,
    COALESCE(s.weight, 0) as weight,
    s.external_product_type,
    COALESCE(sc.price, 15.0 + (p.sku_id % 50)) as current_price,
    COALESCE(sc.old_price, sc.price * 1.2, (15.0 + (p.sku_id % 50)) * 1.2) as original_price
FROM product p
    LEFT JOIN brand b ON p.brand_id = b.id
    LEFT JOIN category cat ON p.subcategory_id = cat.id
    LEFT JOIN sku s ON p.sku_id = s.id
    LEFT JOIN sku_country sc ON p.sku_id = sc.sku_id AND sc.country_id = 1 AND sc.is_disabled = 0
WHERE p.sku_id IN (209, 1259, 1293, 2433, 4160, 5184, 5292, 7010, 8715, 8727, 10119, 10649, 10908, 10954, 13128, 13900, 14963, 16084, 17593, 19553, 19812, 20018, 22258, 24275, 24626, 24876, 28624, 30255, 30257, 30911, 31090, 31091, 31104, 31266, 31317, 31319, 31342, 31366, 31526, 31606, 31783, 31791, 31972, 31973, 32376, 32494, 32519, 32520, 32549, 32550, 32551, 32727, 32920, 32939, 33080, 33097, 33371, 33518, 33652, 33674, 34336, 34387, 34400, 34405, 34435, 34508, 34559, 34679, 34689, 34704, 34752, 34755, 34756, 35123, 35126, 35127, 35136, 35138, 35456, 35469, 35473, 35495, 35804, 36006, 36418, 36453, 36463, 36566, 37300, 37721, 37765, 37767, 37771, 37773, 37786, 38198, 38277, 38301, 38320, 38326, 38331, 38366, 38371, 38373, 38377, 38379, 38381, 38382, 38424, 38430, 38440, 38442, 38444, 38448, 38467, 38501, 38502, 38503, 38510, 38522, 38525, 38533, 38535, 38536, 38537, 38539, 38542, 38550, 38553, 38576, 38605, 38739, 38778, 38780, 38797, 38826, 38839, 38894, 38902, 38922, 38924, 38940, 38972, 39008, 39010, 39098, 39116, 39122, 39228, 39242, 39308, 39313, 39360, 39383, 39384, 39385, 39387, 39396, 39447, 39467, 39490, 39492, 39493, 39527, 39545, 39562, 39570, 39581, 39622, 39650, 39699, 39706, 39715, 39737, 39750, 39780, 39781, 39808, 39834, 39897, 39910, 39958, 39960, 39963, 39968, 39982, 39985, 39987, 40008, 40014, 40039, 40048, 40090, 40112, 40177, 40181, 40292, 40317, 40319, 40365, 40393, 40396, 40422, 40424, 40624, 40630, 40648, 40789, 40851, 40884, 40886, 40887, 40952, 41034, 41176, 41317, 41318, 41319, 41351, 41373, 41379, 41422, 41465, 41480, 41540, 41570, 41637, 41644, 41655, 41690, 41760, 41873, 41876, 41910, 42103, 42149, 42227, 42258, 42260, 42293, 42294, 42295, 42304, 42327, 42336, 42381, 42386, 42400, 42552, 42563, 42568, 42570, 42590, 42964, 42998, 43020, 43121, 43543, 43557, 43574, 43615, 43740, 43741, 43777, 43949, 44693, 44822, 44941, 44948, 45033, 45069, 45330, 45333, 45393, 45411, 45497, 45524, 45541, 45579, 45778, 45951, 46078, 46429, 46457, 46558, 46564, 47315, 47714, 47894, 47897, 47908, 48016, 48136, 48553, 48770, 48895, 48929, 48996, 49084, 49416, 49643, 49651, 49879, 49885, 49896, 49911, 49988, 50079, 50176, 50319, 50345, 50354, 50362, 50372, 50407, 50418, 50420, 50451, 50605, 50629, 50642, 50652, 50674, 50678, 50682, 50688, 50705, 50710, 50760, 50806, 50808, 50843, 50846, 50854, 50855, 50871, 50872, 50877, 51147, 51149, 51151, 51175, 51209, 51301, 51317, 51377, 51537, 51606, 51780, 51830, 51847, 51856, 51957, 52085, 52112, 52131, 52140, 52176, 52178, 52184, 52185, 52201, 52255, 52363, 52410, 52508, 52538, 52834, 53205, 53206, 53319, 53745, 53762, 53880, 53888, 53921, 53945, 53966, 54027, 54173, 54327, 54631, 54979, 55208, 55449, 55971, 56032, 56034, 56413, 56416, 56442, 56636, 56641, 56881, 57017, 57136, 57213, 57331, 57375, 57376, 57890, 57891, 58130, 58132, 58575, 58600, 58604, 58687, 58694, 58743, 58748, 58756, 58757, 58760, 58764, 58773, 58774, 58783, 58784, 58825, 58830, 58831, 58864, 58877, 58878, 58887, 58895, 59005, 59118, 59133, 59140, 59142, 59145, 59149, 59218, 59247, 59269, 59299, 59312, 59333, 59388, 59390, 59441, 59467, 59469, 59521, 59535, 59546, 59582, 59602, 59609, 59626, 59644, 59646, 59649, 59687, 59689, 59703, 59745, 59780, 59782, 59791, 59792, 59812, 59816, 59888, 59960, 60038, 60049, 60052, 60189, 60195, 60197, 60199, 60200, 60203, 60205, 60206, 60209, 60213, 60214, 60268, 60269, 60299, 60303, 60308, 60309, 60311, 60372, 60386, 60426, 60430, 60435, 60442, 60443, 60494, 60507, 60538, 60599, 60609, 60614, 60620, 60721, 60798, 60873, 60927, 60959, 60988, 61008, 61084, 61120, 61267, 61323, 61379, 61402, 61436, 61442, 61449, 61459, 61512, 61538, 61577, 61644, 61661, 61729, 61759, 62001, 62032, 62038, 62068, 62275, 62289, 62292, 62462, 62540, 62612, 62633, 62655, 62663, 62665, 62668, 62669, 62687, 62689, 62692, 62696, 62713, 62776, 62791, 62830, 62915, 62954, 62956, 62967, 62994, 63010, 63119, 63169, 63171, 63172, 63181, 63197, 63200, 63278, 63288, 63299, 63374, 63387, 63392, 63393, 63496, 63506, 63513, 63520, 63533, 63590, 63659, 63668, 63680, 63685, 63697, 63705, 63706, 63708, 63716, 63717, 63718, 63720, 63722, 63738, 63752, 63772, 63799, 63826, 63844, 63912, 63961, 64065, 64139, 64144, 64199, 64363, 64380, 64404, 64408, 64409, 64422, 64426, 64497, 64819, 64830, 64867, 64869, 64874, 64982, 65082, 65149, 65341, 65559, 65606, 65610, 65732, 65808, 66141, 66161, 66218, 66298, 66343, 66373, 66434, 66467, 66625, 66628, 66671, 66682, 66695, 66717, 66771, 66840, 66867, 66869, 66870, 66892, 66909, 66910, 66960, 66971, 66985, 66988, 67000, 67100, 67162, 67165, 67166, 67180, 67183, 67211, 67219, 67224, 67283, 67284, 67294, 67331, 67345, 67346, 67351, 67354, 67546, 67548, 67549, 67553, 67555, 67569, 67575, 67576, 67582, 67701, 67704, 67755, 67757, 67832, 67857, 67916, 67938, 67948, 67949, 67956, 67973, 68050, 68057, 68063, 68065, 68076, 68078, 68101, 68121, 68207, 68211, 68217, 68220, 68222, 68224, 68225, 68226, 68228, 68243, 68249, 68262, 68310, 68318, 68334, 68336, 68345, 68353, 68356, 68362, 68378, 68427, 68429, 68436, 68441, 68470, 68473, 68489, 68510, 68521, 68571, 68583, 68616, 68637, 68640, 68646, 68686, 68694, 68699, 68703, 68704, 68709, 68715, 68744, 68785, 68789, 68790, 68828, 69035, 69052, 69090, 69093, 69109, 69185, 69569, 69674, 69795, 69932, 69955, 69971, 69994, 70301, 70333, 70412, 70448, 70453, 70457, 70548, 70564, 70742, 70868, 70880, 70884, 70898, 70900, 70906, 70958, 70959, 70960, 70961, 71072, 71101, 71111, 71137, 71260, 71263, 71265, 71301, 71444, 71464, 71536, 71604, 71632, 71716, 71803, 71825, 71877, 71919, 71983, 72061, 72222, 72277, 72364, 72506, 72706, 72724, 72833, 72923, 72926, 72947, 72977, 72981, 73208, 73482, 73624, 73655, 73668, 73728, 73789, 73797, 73986, 74013, 74369, 74423, 74433, 74547, 74683, 74684, 74805, 74863, 75150, 75423, 75472, 76036, 76067, 76266, 76270, 76431, 76538, 76559, 76678, 76770, 76775, 76903, 76971, 76990, 77005, 77010, 77015, 77035, 77319, 77560, 77694, 77706, 77709, 77909, 77936, 78027, 78045, 78082, 78153, 78197, 78211, 78233, 78242, 78349, 78360, 78675, 78682, 78685, 78690, 78816, 79309, 79317, 79325, 79352, 79353, 79397, 79445, 79474, 80059, 80326, 80383, 80473, 80594, 80801, 80802, 80844, 80939, 81165, 81309, 81334, 81339, 81341, 81381, 81452, 81548, 81590, 81596, 81601, 81604, 81607, 81613, 81622, 81635, 81696, 81785, 81941, 82011, 82126, 82444, 82493, 82553, 82554, 82734, 82816, 82922, 82950, 83046, 83051, 83087, 83235, 83312, 83369, 83385, 83387, 83463, 83464, 83602, 83603, 83697, 83701, 83736, 83737, 83745, 83747, 83759, 83763, 83766, 83788, 83866, 83874, 83876, 83892, 83908, 83931, 83946, 83955, 83957, 83960, 83962, 83972, 84005, 84009, 84028, 84029, 84056, 84082, 84092, 84115, 84117, 84126, 84130, 84133, 84134, 84136, 84140, 84141, 84142, 84143, 84144, 84161, 84174, 84194, 84195, 84209, 84220, 84241, 84257, 84272, 84282, 84283, 84286, 84300, 84303, 84304, 84311, 84316, 84318, 84324, 84328, 84333, 84347, 84348, 84360, 84370, 84380, 84383, 84409, 84412, 84436, 84438, 84445, 84468)
ORDER BY p.sku_id;

-- Extract missing products - Chunk 2 (CORRECTED)
SELECT 
    p.sku_id,
    COALESCE(p.name_en, CONCAT('Product ', p.sku_id)) as name_en,
    COALESCE(p.name_ar, CONCAT('منتج ', p.sku_id)) as name_ar,
    COALESCE(p.description_en, 'Quality product available for purchase') as description_en,
    COALESCE(p.description_ar, 'منتج عالي الجودة متاح للشراء') as description_ar,
    COALESCE(p.slug, CONCAT('product-', p.sku_id)) as slug,
    COALESCE(p.is_wrappable, 1) as is_wrappable,
    COALESCE(p.is_customizable, 0) as is_customizable,
    COALESCE(p.is_international, 0) as is_international,
    COALESCE(p.is_digital, 0) as is_digital,
    COALESCE(p.origincountry, 'Saudi Arabia') as origincountry,
    COALESCE(p.subcategory_id, 1) as subcategory_id,
    COALESCE(p.brand_id, 1) as brand_id,
    COALESCE(b.name_en, 'Quality Brand') as brand_name_en,
    COALESCE(b.name_ar, 'علامة تجارية ممتازة') as brand_name_ar,
    COALESCE(cat.name_en, 'General Products') as category_name_en,
    COALESCE(cat.name_ar, 'منتجات عامة') as category_name_ar,
    COALESCE(s.code, CONCAT('SKU-', p.sku_id)) as sku_code,
    COALESCE(s.color, 'Multi-Color') as sku_color,
    s.upc,
    COALESCE(s.height, 0) as height,
    COALESCE(s.length, 0) as length,
    COALESCE(s.width, 0) as width,
    COALESCE(s.weight, 0) as weight,
    s.external_product_type,
    COALESCE(sc.price, 15.0 + (p.sku_id % 50)) as current_price,
    COALESCE(sc.old_price, sc.price * 1.2, (15.0 + (p.sku_id % 50)) * 1.2) as original_price
FROM product p
    LEFT JOIN brand b ON p.brand_id = b.id
    LEFT JOIN category cat ON p.subcategory_id = cat.id
    LEFT JOIN sku s ON p.sku_id = s.id
    LEFT JOIN sku_country sc ON p.sku_id = sc.sku_id AND sc.country_id = 1 AND sc.is_disabled = 0
WHERE p.sku_id IN (84489, 84558, 84587, 84603, 84621, 84622, 84624, 84698, 84722, 84727, 84728, 84738, 84739, 84742, 84743, 84751, 84753, 84757, 84762, 84767, 84770, 84774, 84783, 84794, 84795, 84818, 84824, 84827, 84828, 84832, 84834, 84835, 84837, 84850, 84851, 84852, 84859, 84867, 84881, 84884, 84886, 84903, 84909, 84946, 84948, 84969, 84973, 84974, 84977, 84981, 84987, 85011, 85079, 85081, 85087, 85088, 85091, 85093, 85094, 85096, 85097, 85099, 85100, 85106, 85108, 85109, 85111, 85115, 85119, 85125, 85126, 85148, 85154, 85155, 85156, 85158, 85160, 85184, 85191, 85198, 85217, 85223, 85271, 85282, 85299, 85310, 85314, 85317, 85320, 85344, 85350, 85352, 85353, 85369, 85370, 85375, 85412, 85437, 85481, 85487, 85510, 85534, 85537, 85540, 85544, 85545, 85548, 85550, 85553, 85558, 85560, 85564, 85573, 85576, 85578, 85581, 85616, 85620, 85633, 85634, 85642, 85646, 85649, 85665, 85668, 85670, 85749, 85753, 85754, 85801, 85802, 85827, 85839, 85845, 85853, 85855, 85858, 85882, 85883, 85931, 85935, 85937, 85976, 86018, 86023, 86024, 86028, 86029, 86060, 86130, 86143, 86148, 86166, 86191, 86195, 86228, 86231, 86286, 86371, 86430, 86443, 86444, 86451, 86453, 86536, 86562, 86567, 86570, 86583, 86588, 86595, 86597, 86602, 86603, 86604, 86611, 86622, 86625, 86671, 86726, 86744, 86794, 86798, 86818, 86837, 86840, 86843, 86864, 86865, 86896, 86900, 86904, 86937, 86938, 86940, 86942, 86949, 86955, 86968, 86977, 87036, 87038, 87062, 87064, 87065, 87067, 87068, 87069, 87089, 87091, 87120, 87126, 87144, 87149, 87152, 87153, 87161, 87166, 87171, 87196, 87205, 87300, 87322, 87362, 87397, 87405, 87434, 87441, 87470, 87475, 87492, 87494, 87516, 87534, 87579, 87590, 87595, 87603, 87611, 87617, 87618, 87621, 87635, 87638, 87646, 87656, 87662, 87673, 87707, 87708, 87710, 87715, 87716, 87717, 87719, 87722, 87745, 87749, 87783, 87804, 87806, 87819, 87822, 87823, 87828, 87829, 87867, 87872, 87874, 87882, 87888, 87890, 87895, 87896, 87900, 87914, 87940, 87949, 87953, 87959, 87965, 87968, 87974, 88012, 88023, 88029, 88032, 88033, 88036, 88038, 88047, 88049, 88052, 88054, 88072, 88101, 88107, 88119, 88121, 88124, 88129, 88133, 88152, 88175, 88180, 88187, 88189, 88190, 88234, 88251, 88256, 88284, 88285, 88295, 88303, 88318, 88324, 88336, 88350, 88358, 88361, 88363, 88364, 88365, 88367, 88375, 88376, 88379, 88382, 88390, 88403, 88405, 88412, 88413, 88417, 88422, 88425, 88426, 88431, 88440, 88441, 88443, 88450, 88462, 88472, 88489, 88515, 88516, 88542, 88569, 88577, 88600, 88649, 88659, 88661, 88680, 88690, 88692, 88715, 88743, 88744, 88748, 88749, 88752, 88753, 88756, 88764, 88785, 88787, 88788, 88804, 88806, 88809, 88813, 88838, 88894, 88909, 88935, 88974, 88979, 89004, 89009, 89022, 89023, 89034, 89044, 89049, 89081, 89086, 89092, 89213, 89232, 89250, 89282, 89304, 89305, 89321, 89409, 89420, 89459, 89482, 89488, 89498, 89501, 89508, 89553, 89554, 89557, 89597, 89615, 89622, 89633, 89637, 89660, 89675, 89774, 89803, 89804, 89811, 89868, 89892, 89914, 89936, 89950, 89952, 89959, 89963, 89964, 89966, 89975, 89981, 90011, 90012, 90018, 90022, 90023, 90035, 90038, 90039, 90050, 90085, 90096, 90125, 90129, 90141, 90145, 90150, 90159, 90160, 90161, 90163, 90168, 90173, 90176, 90208, 90250, 90252, 90260, 90284, 90386, 90431, 90432, 90435, 90446, 90454, 90456, 90515, 90531, 90541, 90542, 90557, 90558, 90564, 90565, 90570, 90588, 90590, 90604, 90648, 90652, 90662, 90668, 90710, 90711, 90713, 90727, 90739, 90747, 90751, 90815, 90840, 90842, 90864, 90866, 90868, 90872, 90877, 90880, 90881, 90882, 90883, 90885, 90889, 90895, 90916, 90919, 90920, 90925, 90979, 91059, 91076, 91115, 91118, 91126, 91139, 91148, 91149, 91154, 91159, 91164, 91167, 91168, 91169, 91197, 91201, 91218, 91221, 91265, 91274, 91300, 91307, 91315, 91318, 91334, 91391, 91403, 91409, 91436, 91442, 91503, 91524, 91598, 91634, 91636, 91724, 91725, 91731, 91772, 91782, 91784, 91787, 91908, 91934, 91982, 92082, 92153, 92233, 92275, 92371, 92600, 92618, 92717, 92865, 93120, 93140, 93146, 93312, 93370, 93393, 93554, 93585, 93696, 93698, 93720, 93789, 93899, 94089, 94096, 94187, 94188, 94189, 94199, 94200, 94205, 94211, 94285, 94291, 94329, 94390, 94408, 94412, 94413, 94415, 94416, 94417, 94418, 94419, 94420, 94421, 94460, 94493, 94501, 94510, 94512, 94624, 94628, 94668, 94824, 94827, 94830, 94838, 94841, 94852, 94856, 94859, 94863, 94865, 94867, 94885, 94909, 94912, 94927, 94974, 94976, 95058, 95128, 95246, 95252, 95300, 95371, 95408, 95481, 95493, 95643, 95676, 95696, 95842, 96164, 96168, 96169, 96239, 96343, 96353, 96354, 96700, 96754, 96839, 96911, 96920, 96941, 96986, 97037, 97055, 97100, 97131, 97185, 97190, 97210, 97211, 97305, 97475, 97478, 97491, 97493, 97507, 97520, 97530, 97531, 97533, 97538, 97544, 97546, 97554, 97569, 97570, 97574, 97591, 97599, 97600, 97604, 97605, 97618, 97623, 97624, 97631, 97634, 97635, 97636, 97638, 97659, 97660, 97670, 98045, 98046, 98051, 98052, 98062, 98080, 98084, 98090, 98091, 98130, 98132, 98137, 98147, 98156, 98162, 98163, 98164, 98165, 98166, 98168, 98169, 98171, 98173, 98176, 98183, 98198, 98209, 98219, 98222, 98223, 98227, 98231, 98248, 98257, 98281, 98284, 98294, 98297, 98302, 98304, 98537, 98557, 98558, 98580, 98581, 98587, 98600, 98602, 98605, 98651, 98654, 98659, 98661, 98662, 98667, 98671, 98682, 98683, 98691, 98706, 98717, 98720, 98722, 98724, 98725, 98730, 98733, 98742, 98746, 98750, 98761, 98781, 98793, 98798, 98799, 98806, 98815, 98816, 98827, 98836, 98838, 98841, 98923, 99037, 99039, 99048, 99049, 99052, 99057, 99233, 99240, 99314, 99381, 99382, 99384, 99411, 99427, 99489, 99502, 99518, 99519, 99540, 99543, 99545, 99563, 99569, 99570, 99576, 99577, 99581, 99599, 99600, 99604, 99609, 99613, 99615, 99774, 99836, 99851, 99901, 100000, 100004, 100036, 100037, 100045, 100049, 100169, 100212, 100222, 100576, 100613, 100725, 100773, 100776, 100777, 100796, 100978, 100993, 101070, 101071, 101261, 101483, 101497, 101511, 101524, 101527, 101535, 101539, 101542, 101579, 101580, 101582, 101586, 101626, 101640, 101758, 101794, 101797, 101897, 101915, 101953, 102012, 102074, 102076, 102116, 102224, 102277, 102372, 102400, 102453, 102458, 102464, 102480, 102595, 102652, 102679, 102700, 102740, 102746, 102748, 102817, 102835, 102869, 102879, 102971, 103055, 103079, 103091, 103126, 103198, 103218, 103229, 103237, 103266, 103319, 103365, 103366, 103371, 103492, 103583, 103623, 103628, 103629, 103648, 103655, 103662, 103668, 103703, 103710, 103744, 103745, 103746, 103783, 104013, 104017, 104019, 104030, 104031, 104139, 104147, 104151, 104216, 104218, 104219, 104223, 104226, 104227, 104250, 104311, 104317, 104383, 104433, 104437, 104443, 104449, 104452, 104453, 104466, 104468, 104469, 104471, 104483, 104490, 104496, 104497, 104498, 104500, 104501, 104522, 104534, 104536, 104538, 104539, 104601, 104628, 104630, 104633, 104642, 104647, 104663, 104670, 104677, 104694, 104710, 104749, 104760, 104768, 104770, 104781, 104787, 104807, 104810, 104812, 104814, 104824, 104829, 104838, 104840, 104856, 104858, 104864, 104868, 104875, 104876, 104878, 104882, 104886, 104890, 104901, 104909, 104923, 104947, 104957, 104969, 104974, 104991, 105034, 105142, 105152, 105215, 105236, 105306, 105308, 105379, 105382, 105443, 105452, 105606)
ORDER BY p.sku_id;

-- Extract missing products - Chunk 3 (CORRECTED)
SELECT 
    p.sku_id,
    COALESCE(p.name_en, CONCAT('Product ', p.sku_id)) as name_en,
    COALESCE(p.name_ar, CONCAT('منتج ', p.sku_id)) as name_ar,
    COALESCE(p.description_en, 'Quality product available for purchase') as description_en,
    COALESCE(p.description_ar, 'منتج عالي الجودة متاح للشراء') as description_ar,
    COALESCE(p.slug, CONCAT('product-', p.sku_id)) as slug,
    COALESCE(p.is_wrappable, 1) as is_wrappable,
    COALESCE(p.is_customizable, 0) as is_customizable,
    COALESCE(p.is_international, 0) as is_international,
    COALESCE(p.is_digital, 0) as is_digital,
    COALESCE(p.origincountry, 'Saudi Arabia') as origincountry,
    COALESCE(p.subcategory_id, 1) as subcategory_id,
    COALESCE(p.brand_id, 1) as brand_id,
    COALESCE(b.name_en, 'Quality Brand') as brand_name_en,
    COALESCE(b.name_ar, 'علامة تجارية ممتازة') as brand_name_ar,
    COALESCE(cat.name_en, 'General Products') as category_name_en,
    COALESCE(cat.name_ar, 'منتجات عامة') as category_name_ar,
    COALESCE(s.code, CONCAT('SKU-', p.sku_id)) as sku_code,
    COALESCE(s.color, 'Multi-Color') as sku_color,
    s.upc,
    COALESCE(s.height, 0) as height,
    COALESCE(s.length, 0) as length,
    COALESCE(s.width, 0) as width,
    COALESCE(s.weight, 0) as weight,
    s.external_product_type,
    COALESCE(sc.price, 15.0 + (p.sku_id % 50)) as current_price,
    COALESCE(sc.old_price, sc.price * 1.2, (15.0 + (p.sku_id % 50)) * 1.2) as original_price
FROM product p
    LEFT JOIN brand b ON p.brand_id = b.id
    LEFT JOIN category cat ON p.subcategory_id = cat.id
    LEFT JOIN sku s ON p.sku_id = s.id
    LEFT JOIN sku_country sc ON p.sku_id = sc.sku_id AND sc.country_id = 1 AND sc.is_disabled = 0
WHERE p.sku_id IN (105608, 105622, 105661, 105685, 105701, 105768, 106281, 106282, 106349, 106379, 106394, 106410, 106414, 106420, 106423, 106442, 106443, 106444, 106446, 106453, 106459, 106461, 106464, 106465, 106469, 106472, 106475, 106476, 106478, 106481, 106486, 106487, 106489, 106492, 106498, 106502, 106504, 106505, 106508, 106510, 106512, 106513, 106517, 106520, 106523, 106528, 106532, 106544, 106553, 106554, 106565, 106583, 106588, 106593, 106594, 106605, 106725, 106786, 106788, 106845, 106866, 106867, 106870, 106871, 106873, 106875, 106887, 106888, 106906, 106909, 106948, 106951, 107006, 107024, 107030, 107066, 107074, 107113, 107145, 107208, 107255, 107287, 107334, 107411, 107460, 107797, 107832, 107839, 107841, 107859, 108089, 108095, 108109, 108119, 108370, 108373, 108379, 108380, 108465, 108516, 108519, 108525, 108526, 108529, 108530, 108534, 108539, 108574, 108577, 108578, 108655, 108718, 108783, 108809, 108812, 108816, 108820, 108825, 108830, 108832, 108854, 108871, 108872, 108873, 108874, 108875, 108933, 108945, 108948, 108955, 108958, 108967, 108970, 108971, 108972, 108973, 108981, 109316, 109317, 109320, 109344, 109397, 109407, 109411, 109679, 109696, 109792, 109795, 109800, 109802, 109872, 109897, 109898, 109899, 110013, 110050, 110145, 110197, 110213, 110221, 110233, 110238, 110262, 110332, 110334, 110338, 110342, 110348, 110423, 110436, 110439, 110458, 110459, 110464, 110470, 110475, 110721, 110769, 110799, 110906, 110911, 110924, 110958, 110961, 110968, 110974, 110975, 111000, 111131, 111138, 111172, 111274, 111275, 111276, 111285, 111286, 111289, 111292, 111314, 111334, 111493, 111629, 111658, 111660, 111662, 111713, 111757, 111759, 111840, 111871, 111872, 111913, 111914, 112018, 112022, 112023, 112241, 112250, 112283, 112284, 112307, 112314, 112316, 112389, 112429, 112457, 112471, 112476, 112483, 112487, 112493, 112494, 112499, 112501, 112511, 112513, 112529, 112841, 113080, 113083, 113120, 113279, 113298, 113300, 113302, 113306, 113308, 113409, 113411, 113413, 113447, 113448, 113482, 113485, 113496, 113497, 113498, 113538, 113551, 113552, 113556, 113560, 113565, 113568, 113570, 113716, 113717, 113718, 114122, 114168, 114199, 114260, 114265, 114293, 114311, 114315, 114327, 114341, 114343, 114358, 114448, 114451, 114460, 114468, 114771, 114851, 114936, 115041, 115050, 115096, 115102, 115109, 115110, 115113, 115129, 115130, 115132, 115139, 115208, 115273, 115335, 115349, 115403, 115404, 115441, 115454, 115488, 115489, 115491, 115496, 115500, 115501, 115530, 115532, 115540, 115543, 115544, 115611, 115626, 115628, 115630, 115636, 115637, 115641, 115736, 115779, 115905, 115907, 115975, 115980, 116021, 116028, 116029, 116032, 116034, 116035, 116037, 116038, 116040, 116045, 116046, 116049, 116050, 116051, 116052, 116183, 116233, 116476, 116491, 116621, 116718, 116721, 116726, 116743, 116765, 116825, 116827, 117182, 117241, 117349, 117351, 117352, 117364, 117366, 117555, 117558, 117575, 117577, 117610, 117612, 117614, 117615, 117616, 117715, 117716, 117720, 117726, 117727, 117735, 117808, 117908, 118052, 118053, 118056, 118060, 118115, 118116, 118120, 118376, 118418, 118419, 118424, 118427, 118430, 118434, 118435, 118447, 118453, 118461, 118482, 118529, 118533, 118536, 118600, 118641, 118696, 118794, 118795, 118898, 118922, 118925, 118940, 119100, 119142, 119241, 119373, 119405, 119451, 119497, 119500, 119528, 119551, 119723, 119843, 119852, 119858, 119866, 119867, 119869, 119875, 119956, 120023, 120062, 120063, 120131, 120168, 120185, 120321, 120363, 120603, 120625, 120698, 120709, 121059, 121082, 121084, 121100, 121107, 121108, 121121, 121175, 121259, 121281, 121304, 121310, 121412, 121438, 121600, 121768, 121769, 121773, 121774, 121779, 121780, 121782, 121783, 121790, 121791, 122085, 122095, 122347, 122349, 122442, 122454, 122520, 122521, 122522, 122524, 122562, 122563, 122568, 122592, 122594, 122654, 122655, 122660, 122671, 122685, 122688, 122700, 122701, 122714, 122724, 122733, 122740, 122741, 122744, 122772, 122778, 122789, 122860, 122887, 122888, 122993, 122994, 122997, 123014, 123016, 123114, 123146, 123149, 123500, 123551, 123568, 123574, 123580, 123585, 123698, 123719, 124194, 124238, 124269, 124270, 124271, 124278, 124279, 124417, 124423, 124429, 124436, 124441, 124445, 124473, 124714, 124739, 124754, 124865, 124867, 124884, 124886, 124899, 124901, 124906, 124941, 125098, 125125, 125128, 125139, 125152, 125193, 125509, 125510, 125850, 125852, 125853, 125876, 125955, 125983, 125984, 125985, 126005, 126021, 126028, 126525, 126541, 126546, 126758, 126787, 126806, 126814, 126815, 126831, 126848, 126930, 127066, 127098, 127100, 127111, 127123, 127135, 127225, 127227, 127228, 127238, 127255, 127256, 127259, 127622, 127627, 127779, 127781, 128141, 128447, 128448, 128457, 128895, 128907, 128913, 129130, 129133, 129136, 129189, 129190, 129191, 129196, 129202, 129215, 129225, 129302, 129306, 129308, 129333, 129334, 129335, 129336, 129404, 129435, 129443, 129445, 129458, 129460, 129461, 129463, 129471, 129472, 129511, 129523, 129525, 129572, 129580, 129591, 129634, 129635, 129644, 129657, 129686, 129689, 129691, 130282, 130284, 130299, 130410, 130494, 130497, 130498, 130509, 130671, 130675, 130676, 130677, 130679, 130680, 130681, 130682, 130683, 130685, 130686, 130688, 130756, 130971, 131023, 131129, 131134, 131138, 131147, 131148, 131151, 131156, 131175, 131179, 131265, 131270, 131278, 131286, 131288, 131291, 131295, 131302, 131309, 131311, 131316, 131319, 131322, 131347, 131348, 131359, 131360, 131441, 131446, 131449, 131452, 131483, 131754, 131755, 131757, 131758, 131761, 131768, 131780, 131782, 131789, 131812, 131866, 131872, 131895, 131938, 131942, 131943, 131950, 131953, 131980, 131982, 131983, 131995, 131998, 132000, 132003, 132004, 132005, 132007, 132009, 132010, 132012, 132013, 132014, 132015, 132022, 132023, 132025, 132026, 132028, 132036, 132038, 132041, 132074, 132075, 132077, 132078, 132079, 132082, 132083, 132090, 132097, 132098, 132099, 132127, 132133, 132264, 132265, 132272, 132298, 132520, 132521, 132522, 132559, 132560, 132563, 132564, 132568, 132570, 132571, 132572, 132577, 132578, 132581, 132582, 132584, 132585, 132588, 132589, 132596, 132597, 132599, 132603, 132604, 132605, 132608, 132609, 132611, 132612, 132615, 132617, 132620, 132621, 132622, 132694, 132696, 132698, 132700, 132704, 132718, 132733, 132738, 132739, 132740, 132741, 132747, 132749, 132751, 132753, 132756, 132796, 132797, 132798, 132804, 132822, 132825, 132834, 132851, 132853, 132857, 132858, 132981, 132996, 132999, 133002, 133004, 133006, 133008, 133011, 133015, 133058, 133091, 133100, 133165, 133166, 133213, 133279, 133283, 133291, 133295, 133298, 133336, 133337, 133340, 133349, 133371, 133521, 133808, 133810, 133812, 133814, 133967, 133969, 133983, 134000, 134296, 134297, 134311, 134337, 134353, 134355, 134358, 134372, 134376, 134378, 134383, 134385, 134716, 134721, 134749, 134751, 134855, 134859, 134909, 134910, 134942, 134943, 134953, 134954, 134956, 134961, 134964, 134965, 134968, 134969, 134971, 134972, 135020, 135104, 135127, 135144, 135145, 135147, 135150, 135203, 135209, 135210, 135323, 135325, 135333, 135336, 135338, 135340, 135352, 135361, 135388, 135398, 135548, 135549, 136028, 136029, 136037)
ORDER BY p.sku_id;